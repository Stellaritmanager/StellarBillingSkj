--LoanReport--

insert into ShGenericReport values
('LeeMobiles','LoanReport','csv','To get Loan Distributed','Select bh.BillID,sbm.BranchName,scm.CustomerName,scm.MobileNumber,bh.BillDate,bh.LoanValue,bh.NoOfItem,bh.OverallWeight as ''TotalGrams''
from Shbillmasterskj bh
inner join SHCustomerMaster scm on convert(int,scm.CustomerID) =bh.CustomerID  and bh.IsDelete=0
inner join SHBranchMaster Sbm on sbm.BracnchID= bh.BranchID where 1=1
','bh.BillDate','',0)


--LoanDueReport---

insert into ShGenericReport values
('LeeMobiles','LoanDueReport','csv','To get Loan Distributed','Select bh.BillID,sbm.BranchName,scm.CustomerName,scm.MobileNumber,bh.BillDate,bh.LoanValue,isnull(spd.Balance,bh.LoanValue) as ''DueAmount''
, DateDiff(DAY,bh.billDate,getdate()) as PastDueDays,bh.ClosingStatus as ''Status''
from Shbillmasterskj bh
inner join SHCustomerMaster scm on convert(int,scm.CustomerID) =bh.CustomerID and bh.IsDelete=0
inner join SHBranchMaster Sbm on sbm.BracnchID= bh.BranchID 
left join SHPaymentMaster spd on spd.BillId = bh.BillID
where 1=1 
','bh.BillDate','',0)


---Payment Details Report----
insert into ShGenericReport values
('LeeMobiles','PaymentsReport','csv','To get payment details','Select sbm.BillID,sbr.BranchName,scm.CustomerName,scm.MobileNumber,bh.PaymentDate,bh.PaymentAmount,isnull(bh.PaymentMode,'''') as ''PaymentMode'',
isnull(bh.PaymentTransactionNumber,'''') as ''TransactionNumber''
from SHPaymentMaster spd
inner join SHPaymentDetails bh on spd.PaymentId= bh.PaymentId and bh.IsDelete=0
inner join Shbillmasterskj sbm on sbm.BillID =spd.BillId 
inner join SHCustomerMaster scm on convert(int,scm.CustomerID) =sbm.CustomerID 
inner join SHBranchMaster Sbr on sbr.BracnchID= bh.BranchID 
where 1=1
','bh.PaymentDate','',0)

--Customer wise loan report--

insert into ShGenericReport values
('LeeMobiles','CustomerWiseLoanReport','csv','To get Customer wise loan and payment details','
select  scm.CustomerName, scm.MobileNumber, sum(isnull(bh.LoanValue,0.00)) as ''TotalLoanAmount'',
 (sum(isnull(bh.LoanValue,0.00))-sum(isnull(convert(money,shp.Balance),0.00))) as ''TotalPaid'',
sum(isnull(convert(money,shp.Balance),0.00))as ''TotalBalance''
 from SHCustomerMaster scm
left join
Shbillmasterskj bh on bh.CustomerID=scm.CustomerID and bh.IsDelete=0 
left join
SHPaymentMaster shp on shp.BillId =shp.BillId and bh.IsDelete=0 and shp.BranchID= bh.BranchID
where 1=1 
','bh.BillDate',' Group by scm.CustomerName, scm.MobileNumber',0)